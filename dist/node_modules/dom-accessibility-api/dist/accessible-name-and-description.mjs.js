import e from"./polyfills/array.from.mjs.js";import r from"./polyfills/SetLike.mjs.js";import{safeWindow as t,queryIdRefs as n,hasAnyConcreteRoles as i,isElement as u,isHTMLInputElement as a,isHTMLTableCaptionElement as o,isHTMLSelectElement as l,isHTMLTextAreaElement as d,isHTMLSlotElement as c,isHTMLFieldSetElement as s,isHTMLLegendElement as f,isHTMLTableElement as b,isSVGSVGElement as m,isSVGTitleElement as v,isHTMLOptGroupElement as p}from"./util.mjs.js";import{getLocalName as g}from"./getRole.mjs.js";function h(e){return e.trim().replace(/\s\s+/g," ")}function y(e,r){if(!u(e))return!1;if(e.hasAttribute("hidden")||"true"===e.getAttribute("aria-hidden"))return!0;var t=r(e);return"none"===t.getPropertyValue("display")||"hidden"===t.getPropertyValue("visibility")}function E(e){return i(e,["button","combobox","listbox","textbox"])||x(e,"range")}function x(e,r){if(!u(e))return!1;if("range"===r)return i(e,["meter","progressbar","scrollbar","slider","spinbutton"]);throw new TypeError("No knowledge about abstract role '".concat(r,"'. This is likely a bug :("))}function I(r,t){var i=e(r.querySelectorAll(t));return n(r,"aria-owns").forEach((function(r){i.push.apply(i,e(r.querySelectorAll(t)))})),i}function L(e){return l(e)?e.selectedOptions||I(e,"[selected]"):I(e,'[aria-selected="true"]')}function R(e){return i(e,["none","presentation"])}function A(e){return o(e)}function w(e){return i(e,["button","cell","checkbox","columnheader","gridcell","heading","label","legend","link","menuitem","menuitemcheckbox","menuitemradio","option","radio","row","rowheader","switch","tab","tooltip","treeitem"])}function j(e){return a(e)||d(e)?e.value:e.textContent||""}function S(e){var r=e.getPropertyValue("content");return/^["'].*["']$/.test(r)?r.slice(1,-1):""}function N(e){var r=g(e);return"button"===r||"input"===r&&"hidden"!==e.getAttribute("type")||"meter"===r||"output"===r||"progress"===r||"select"===r||"textarea"===r}function k(e){if(N(e))return e;var r=null;return e.childNodes.forEach((function(e){if(null===r&&u(e)){var t=k(e);null!==t&&(r=t)}})),r}function C(e){if(void 0!==e.control)return e.control;var r=e.getAttribute("for");return null!==r?e.ownerDocument.getElementById(r):k(e)}function P(r){var t=r.labels;if(null===t)return t;if(void 0!==t)return e(t);if(!N(r))return null;var n=r.ownerDocument;return e(n.querySelectorAll("label")).filter((function(e){return C(e)===r}))}function T(r){var t=r.assignedNodes();return 0===t.length?e(r.childNodes):t}function V(l){var d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},I=new r,N=t(l),k=d.compute,C=void 0===k?"name":k,V=d.computedStyleSupportsPseudoElements,q=void 0===V?void 0!==d.getComputedStyle:V,D=d.getComputedStyle,O=void 0===D?N.getComputedStyle.bind(N):D,B=d.hidden,Q=void 0!==B&&B;function X(r,t){var i="";if(u(r)&&q){var a=S(O(r,"::before"));i="".concat(a," ").concat(i)}if((c(r)?T(r):e(r.childNodes).concat(n(r,"aria-owns"))).forEach((function(e){var r=_(e,{isEmbeddedInLabel:t.isEmbeddedInLabel,isReferenced:!1,recursion:!0}),n="inline"!==(u(e)?O(e).getPropertyValue("display"):"inline")?" ":"";i+="".concat(n).concat(r).concat(n)})),u(r)&&q){var o=S(O(r,"::after"));i="".concat(i," ").concat(o)}return i.trim()}function $(r){if(!u(r))return null;function t(e,r){var t=e.getAttributeNode(r);return null===t||I.has(t)||""===t.value.trim()?null:(I.add(t),t.value)}if(s(r)){I.add(r);for(var n=e(r.childNodes),l=0;l<n.length;l+=1){var d=n[l];if(f(d))return _(d,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(b(r)){I.add(r);for(var c=e(r.childNodes),h=0;h<c.length;h+=1){var y=c[h];if(o(y))return _(y,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else{if(m(r)){I.add(r);for(var E=e(r.childNodes),x=0;x<E.length;x+=1){var L=E[x];if(v(L))return L.textContent}return null}if("img"===g(r)||"area"===g(r)){var R=t(r,"alt");if(null!==R)return R}else if(p(r)){var A=t(r,"label");if(null!==A)return A}}if(a(r)&&("button"===r.type||"submit"===r.type||"reset"===r.type)){var w=t(r,"value");if(null!==w)return w;if("submit"===r.type)return"Submit";if("reset"===r.type)return"Reset"}var j=P(r);if(null!==j&&0!==j.length)return I.add(r),e(j).map((function(e){return _(e,{isEmbeddedInLabel:!0,isReferenced:!1,recursion:!0})})).filter((function(e){return e.length>0})).join(" ");if(a(r)&&"image"===r.type){var S=t(r,"alt");if(null!==S)return S;var N=t(r,"title");return null!==N?N:"Submit Query"}if(i(r,["button"])){var k=X(r,{isEmbeddedInLabel:!1,isReferenced:!1});return""!==k?k:t(r,"title")}return t(r,"title")}function _(r,t){if(I.has(r))return"";if(!Q&&y(r,O)&&!t.isReferenced)return I.add(r),"";var o=n(r,"aria-labelledby");if("name"===C&&!t.isReferenced&&o.length>0)return o.map((function(e){return _(e,{isEmbeddedInLabel:t.isEmbeddedInLabel,isReferenced:!0,recursion:!1})})).join(" ");var l=t.recursion&&E(r)&&"name"===C;if(!l){var d=(u(r)&&r.getAttribute("aria-label")||"").trim();if(""!==d&&"name"===C)return I.add(r),d;if(!R(r)){var c=$(r);if(null!==c)return I.add(r),c}}if(i(r,["menu"]))return I.add(r),"";if(l||t.isEmbeddedInLabel||t.isReferenced){if(i(r,["combobox","listbox"])){I.add(r);var s=L(r);return 0===s.length?a(r)?r.value:"":e(s).map((function(e){return _(e,{isEmbeddedInLabel:t.isEmbeddedInLabel,isReferenced:!1,recursion:!0})})).join(" ")}if(x(r,"range"))return I.add(r),r.hasAttribute("aria-valuetext")?r.getAttribute("aria-valuetext"):r.hasAttribute("aria-valuenow")?r.getAttribute("aria-valuenow"):r.getAttribute("value")||"";if(i(r,["textbox"]))return I.add(r),j(r)}return w(r)||u(r)&&t.isReferenced||A(r)?(I.add(r),X(r,{isEmbeddedInLabel:t.isEmbeddedInLabel,isReferenced:!1})):r.nodeType===r.TEXT_NODE?(I.add(r),r.textContent||""):t.recursion?(I.add(r),X(r,{isEmbeddedInLabel:t.isEmbeddedInLabel,isReferenced:!1})):(I.add(r),"")}return h(_(l,{isEmbeddedInLabel:!1,isReferenced:"description"===C,recursion:!1}))}export{V as computeTextAlternative};
//# sourceMappingURL=accessible-name-and-description.mjs.js.map
