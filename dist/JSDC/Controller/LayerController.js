import{__extends as e}from"../../node_modules/tslib/tslib.es6.js";import{get as t,pick as o}from"lodash";import i from"../utils/Event.js";import n from"../utils/AssociativeArray.js";import r from"./AbstractController.js";var s=function(r){function s(){var e=null!==r&&r.apply(this,arguments)||this;return e.layers=new n,e.onAddEvent=new i,e.onRemoveEvent=new i,e.onChangeEvent=new i,e.onUpdateEvent=new i,e.layerInfos=[],e.exceptionIds=[],e.setLayerList=function(){var t=e.layers.omit(e.exceptionIds);return e.layerInfos=t.map((function(e){return o(e,["id","description","show"])})),e.onUpdateEvent.raise(),e.layerInfos},e}return e(s,r),s.prototype.showByNames=function(e,o){var i=this;void 0===o&&(o=!1);var n=e.map((function(e){return t(i.getByName(e),"id")})).filter((function(e){return void 0!==e}));o?this.layers.omit(n).forEach((function(e){return e.show=!1})):this.layers.gets(n).forEach((function(e){return e.show=!0})),this.setLayerList()},s.prototype.add=function(e,t){var o=void 0===t?{}:t,i=o.hidden,n=void 0!==i&&i,r=o.addToMap,s=void 0===r||r,a=s?e.isInstanceExistStrict():e;n&&this.exceptionIds.push(a.id),s&&this.validateViewer().addLayer(a.instance),this.layers.set(a.id,a),this.setLayerList(),this.onAddEvent.raise({layer:a}),this.onChangeEvent.raise({layer:a,type:"add"}),a.onToggleShowEvent.addEventListener(this.setLayerList)},s.prototype.get=function(e){return this.getById(e.id)},s.prototype.getById=function(e){return this.layers.get(e)},s.prototype.getByName=function(e){return this.layers.values.find((function(t){return t.description.name===e}))},s.prototype.remove=function(e,t){var o=(void 0===t?{}:t).removeFromMap;(void 0===o||o)&&this.validateViewer().removeLayer(e.isInstanceExistStrict().instance);var i=this.exceptionIds.indexOf(e.id);i>-1&&this.exceptionIds.splice(i,1),this.layers.remove(e.id),this.setLayerList(),this.onRemoveEvent.raise({layer:e}),this.onChangeEvent.raise({layer:e,type:"remove"}),e.onToggleShowEvent.removeEventListener(this.setLayerList)},s.prototype.removeById=function(e,t){void 0===t&&(t={});var o=this.getById(e);this.remove(o,t)},s.prototype.removeAll=function(){for(;this.layers.values.length>0;)this.remove(this.layers.values[0],{removeFromMap:!0});this.exceptionIds=[]},s.prototype.destroy=function(){r.prototype.destroy.call(this),this.removeAll(),this.onAddEvent.removeAllEvents(),this.onChangeEvent.removeAllEvents(),this.onRemoveEvent.removeAllEvents()},s}(r);export{s as default};
//# sourceMappingURL=LayerController.js.map
