import{__awaiter as e,__generator as t,__assign as n}from"../../../node_modules/tslib/tslib.es6.js";import{uniqueId as i}from"lodash";import r,{useRef as o,useState as c,useEffect as a}from"react";import l from"./WeatherCard.js";import{getTwoDays as s}from"./src/api.js";import u from"./src/Weather.js";import m from"../../../icon/index.js";var f=function(){function e(e,t){this.id=i(),this.county=e,this.town=t}return Object.defineProperty(e.prototype,"fullName",{get:function(){return"".concat(this.county," ").concat(this.town)},enumerable:!1,configurable:!0}),e}(),d=function(i){var d=i.locations,p=i.token,v=i.onSelectLocation,h=void 0===v?function(){return null}:v,g=o(null),N=c(!0),E=N[0],w=N[1],b=c(!1),y=b[0],j=b[1],k=c(d.map((function(e){return new f(e.county,e.town)})))[0],C=c(k[0]),x=C[0],W=C[1],L=c([]),D=L[0],O=L[1],P=c({}),S=P[0],_=P[1],q=c(),z=q[0],A=q[1];return a((function(){e(void 0,void 0,void 0,(function(){var e,i,r,o,c,a;return t(this,(function(l){switch(l.label){case 0:e=[],i={},r=function(r){var o,c,a,l,m;return t(this,(function(t){switch(t.label){case 0:return[4,s(r.county,r.town,p)];case 1:return o=t.sent(),c=new u(r.id,o),e.push(c),a=c.wx.getElements(),l=c.temp.getElements(),m=c.ci.getElements(),i[r.id]=a.map((function(e,t){var i=n({},e);return i.temp=l[t].description,i.ci=m[t].value,i})),[2]}}))},o=0,c=k,l.label=1;case 1:return o<c.length?(a=c[o],[5,r(a)]):[3,4];case 2:l.sent(),l.label=3;case 3:return o++,[3,1];case 4:return _(i),A(e),O(i[x.id]),w(!1),[2]}}))}))}),[]),r.createElement("div",{className:"dui-WeatherDialogContent"},r.createElement("div",{className:"select",ref:g},r.createElement("span",{className:"selected",onClick:function(){return j(!y)}},x.fullName,r.createElement("div",{className:"pointer"},"â–¼")),r.createElement("div",{className:"option ".concat(y||"hide")},k.map((function(e){return r.createElement("div",{key:e.fullName,className:"item",onClick:function(){return function(e){W(e),O(S[e.id]);var t=null==z?void 0:z.find((function(t){return t.name===e.id}));j(!1),t&&h([t.location.lat,t.location.lon])}(e)}},e.fullName)})))),E&&r.createElement("img",{className:"loading",src:m.others.processing,alt:"source not found"}),r.createElement("div",{className:"weather-card-container"},D.map((function(e,t){return r.createElement(l,{key:t,title:e.time,img:e.img,degree:e.temp,description:e.description,infoList:[e.ci],imgNum:e.value})}))))};export{d as default};
//# sourceMappingURL=WeatherDialogContent.js.map
