import{__awaiter as e,__generator as t,__assign as n}from"../../../node_modules/tslib/tslib.es6.js";import{uniqueId as r}from"lodash";import i,{useRef as o,useState as c,useEffect as a}from"react";import l from"./WeatherCard.js";import{getTwoDays as s}from"./src/api.js";import u from"./src/Weather.js";import m from"../../../icon/index.js";var f=function(){function e(e,t){this.id=r(),this.county=e,this.town=t}return Object.defineProperty(e.prototype,"fullName",{get:function(){return"".concat(this.county," ").concat(this.town)},enumerable:!1,configurable:!0}),e}(),d=function(r){var d=r.locations,p=r.token,v=r.onSelectLocation,h=void 0===v?function(){return null}:v,g=o(null),N=c(!0),E=N[0],w=N[1],b=c(!1),y=b[0],j=b[1],k=c(d.map((function(e){return new f(e.county,e.town)})))[0],C=c(k[0]),x=C[0],W=C[1],L=c([]),D=L[0],O=L[1],P=c({}),S=P[0],_=P[1],q=c(),z=q[0],A=q[1];return a((function(){e(void 0,void 0,void 0,(function(){var e,r,i,o,c,a;return t(this,(function(l){switch(l.label){case 0:e=[],r={},i=function(i){var o,c,a,l,m;return t(this,(function(t){switch(t.label){case 0:return[4,s(i.county,i.town,p)];case 1:return o=t.sent(),c=new u(i.id,o),e.push(c),a=c.wx.getElements(),l=c.temp.getElements(),m=c.ci.getElements(),r[i.id]=a.map((function(e,t){var r=n({},e);return r.temp=l[t].description,r.ci=m[t].value,r})),[2]}}))},o=0,c=k,l.label=1;case 1:return o<c.length?(a=c[o],[5,i(a)]):[3,4];case 2:l.sent(),l.label=3;case 3:return o++,[3,1];case 4:return _(r),A(e),O(r[x.id]),w(!1),[2]}}))}))}),[]),i.createElement("div",{className:"rui-WeatherDialogContent"},i.createElement("div",{className:"select",ref:g},i.createElement("span",{className:"selected",onClick:function(){return j(!y)}},x.fullName,i.createElement("div",{className:"pointer"},"â–¼")),i.createElement("div",{className:"option ".concat(y||"hide")},k.map((function(e){return i.createElement("div",{key:e.fullName,className:"item",onClick:function(){return function(e){W(e),O(S[e.id]);var t=null==z?void 0:z.find((function(t){return t.name===e.id}));j(!1),t&&h([t.location.lat,t.location.lon])}(e)}},e.fullName)})))),E&&i.createElement("img",{className:"loading",src:m.others.processing,alt:"source not found"}),i.createElement("div",{className:"weather-card-container"},D.map((function(e,t){return i.createElement(l,{key:t,title:e.time,img:e.img,degree:e.temp,description:e.description,infoList:[e.ci],imgNum:e.value})}))))};export{d as default};
//# sourceMappingURL=WeatherDialogContent.js.map
